<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <title>WebGL App</title>
    <style>
        html, head, body {
            margin: 0;
            padding: 25px;
            background-color: #2a2a2a;
            color:#eee;
        }
        #gl-canvas {
            background-color: #da6052;
        }
        #error-box {
            min-width: 700px;
            min-height: 700px;
            color: #ff0000;
            font-weight: 500;
            font-size: 18pt;
            border: 1px solid white;
            padding: 25px;
            /* margin-top: 20px; */
        }

        .error-box-title {
            color: #eee;
            border-bottom: 1px solid gray;
        }

        #tab {
            white-space: pre;
        }        
    </style>
</head>

<body>
    <div style="display:flex; gap:20px;">
        <canvas id="gl-canvas" width="700" height="700"></canvas>
        <div id="error-box">
            <span class="error-box-title">Error Box</span>
        </div>
    </div>
    <div>
        Camera - X Axis Rotation - 
        0<input id="x_slide" type="range" min="0" max="360.0" step="1.0" value="30.0" />360.0 
    </div>
    <div>
        Camera - Y Height  Rotation - 
        -0.5<input id="y_slide" type="range" min="-0.5" max="10.0" step="0.1" value="2.5" />10.0 
    </div>
    <div>
        Zoom - 
        0.2<input id="z_slide" type="range" min="0.2" max="2.0" step="0.05" value="1.0" />2.0 
    </div>
    <div>
        <input type="checkbox" id="movement_toggle" value="true" checked>Toggle Movement</button>
        <input type="checkbox" id="projection_toggle" value="true" checked>Toggle Prespective - Orthogonal</button>
        <input type="checkbox" id="light_movement_toggle" value="true" checked>Toggle Light Movement</button>
    </div>
    <hr>
    <h3>Lighting Controls</h3>
    <div>
        Rotating Light Speed - 
        0<input id="rot_speed_slide" type="range" min="0.0" max="180.0" step="1.0" value="1.0" />180.0 
    </div>
    <div>
        Static Light Y-Position - 
        0.2<input id="static_y_slide" type="range" min="0.2" max="10.0" step="0.1" value="1.0" />10.0 
    </div>
    <div>
        Specular Shininess (Exponent) - 
        1.0<input id="shininess_slide" type="range" min="1.0" max="100.0" step="1.0" value="1.0" />100.0 
    </div>
    <img src="image.jpg">

    <!--     uniform mat4 projectionMatrix;     -->
    <script id="vertex-shader" type="x-shader/x-vertex">
    #version 300 es

    in  vec4 aPosition;
    in  vec3 aNormal;
    in  vec2 aTexCoord;
    
    out vec3 vNormal;
    out vec3 vPosition;
    out vec2 vTexCoord;
    
    uniform mat4 worldMatrix;
    uniform mat4 viewProjectionMatrix;
    uniform mat3 normalMatrix;

    void main()
    {
        vec4 worldPosition = worldMatrix * aPosition;
        vPosition = worldPosition.xyz;
        vNormal = normalMatrix * aNormal;
        vTexCoord = aTexCoord;
        gl_Position = viewProjectionMatrix * worldPosition;
    }
    </script>

    <script id="fragment-shader" type="x-shader/x-fragment">
    #version 300 es

    precision mediump float;

    in vec3 vNormal;
    in vec3 vPosition;
    in vec2 vTexCoord;

    out vec4 fColor;

    uniform vec4 uAmbientProduct;
    uniform vec4 uDiffuseProduct;
    uniform vec4 uSpecularProduct;
    uniform float uShininess;
    
    uniform vec4 uLightPosition;
    uniform vec3 uEyePosition;
    uniform sampler2D uTextureMap;

    void
    main()
    {
        vec3 N = normalize(vNormal);
        vec3 L;
        if (uLightPosition.w == 0.0) {
            L = normalize(uLightPosition.xyz);
        } else {
            L = normalize(uLightPosition.xyz - vPosition);
        }
        vec3 V = normalize(uEyePosition - vPosition);
        vec3 H = normalize(L + V);
        
        vec4 ambient = uAmbientProduct;
        vec4 diffuse = max(dot(L, N), 0.0) * uDiffuseProduct; 
        vec4 specular = pow(max(dot(N, H), 0.0), uShininess) * uSpecularProduct;

        if (dot(L, N) < 0.0) {
            specular = vec4(0.0, 0.0, 0.0, 1.0);  
        }

        vec4 lighting = ambient + diffuse + specular;
        vec4 textureColor = texture(uTextureMap, vTexCoord);

        fColor = textureColor * lighting;
        fColor.a = 1.0;
    }
    </script>

    <!-- <script src="geometry.js"></script> -->
    <script src="webgl-utils.js"></script>
    <script src="MV.js"></script>
    <script src="webgl-scripts.js"></script>
</body>
</html>
